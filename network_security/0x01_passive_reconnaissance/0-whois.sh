#!/bin/bash
whois "$1" | awk -F: '/Registrant|Admin|Tech/ && $1 !~ /Registry/ {gsub(/^ +| +$/,"",$2); if($1 ~ /Street$/) $2=$2" "; if($1 ~ /Phone Ext|Fax Ext/ && $1 !~ /:$/) $1=$1":"; lines[++n]=$1","$2} END {for(i=1;i<=n;i++) printf "%s%s", lines[i], (i<n?ORS:"")}' > "$1.csv"